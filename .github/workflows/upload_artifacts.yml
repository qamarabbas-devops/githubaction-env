name: Demo 05 - Pull Request

on:
    pull_request:
        branches:
            - main

jobs:
    build-test-branch:
        name: "Build and Test Of PR"
        runs-on: ubuntu-latest
        
        steps:
            - uses: action/checkout@v4

            - name: Setup .NET Core
              uses: action/setup-dotnet@v3
              with:
                dotnet-version: 3.1.301

            - name: Install dependencies
              run: dotnet restore "${{ github.workspace }}/mywebapp/mywebapp.csproj"
              
            - name: Build
              run: dotnet build "${{ github.workspace }}/mywebapp/mywebapp.csproj" --configuration Release --no-restore
              
            - name: Test
              run: dotnet test "${{ github.workspace }}/mywebapp/mywebapp.csproj" --no-restore --verbosity normal
              
            - name: Publish
              run: |
               dotnet publish "${{ github.workspace }}/mywebapp/mywebapp.csproj" -c Release -o mywebapp 
               
            - name: Upload a Build Artifact
              uses: actions/upload-artifact@v2.2.0
              with:
                name: mywebappbuildartifacts
                path: mywebapp/**
                if-no-files-found: error
                
                retention-days: 90
              